#!/usr/bin/env bash

BASE='http://actions-service-alb-2007321336.us-east-1.elb.amazonaws.com/action'
REQ_ID='0d9d21fb-e26d-41f5-9842-a5ba221cacc8'
API_KEY='CVr4aTJ6Yu4DPN7mU3VjTg'

# List of IDs (one per line)
read -r -d '' IDS <<'EOF'
0x212d3e83f725c4a57f65a73e36af27cfc3bface4-eip155%3A8453-0x2577050b5964e7cd1d6064b8525cc514c31994cde22b0026bab9cf6837161635
0x3b22be2c26c7fadb14ca8ee849d92a3c37249a45-eip155%3A8453-0x3a708a6560141419696038721bcd05fea41b9dc4dd8b0eb45f23afbd89723c83
0xf70da97812cb96acdf810712aa562db8dfa3dbef-eip155%3A8453-0xde74d0fbcb4704b2eeb995076708aaaf6e5d8ef57e8230588ed9a2b9b12df09a
0x2768c0324561104d87fc6f7506758e98bc7ee2b4-eip155%3A8453-0xec874f729b1171a99cd3e317c5d6400afcb0bc90b3433cc5d894ef0c6f9cf312
0x2768c0324561104d87fc6f7506758e98bc7ee2b4-eip155%3A8453-0xec874f729b1171a99cd3e317c5d6400afcb0bc90b3433cc5d894ef0c6f9cf312
0x00687e946c49391fbacf1ecb98e6453d6ec9c009-eip155%3A8453-0x1c519cad4b700bc309c1e58b7e488f53541ddb9c9bcefad3165eaba38a9bef5e
0x399ffeee2b7e86d69a2b2bba51d882eb3a83e196-eip155%3A8453-0x4da9cf0a3f91dbca18771e4dfa7e835eadc019775835f59106d4be6a2e933fc9
0xa391e9d40177d93dbf63082ace51bc39cda3ae79-eip155%3A8453-0xe69846e82473b2793261b5e970c41a94cbb18d36e70bd6c47806183887018f37
0x4b82847c82087ea19418bed079966810f64f39f4-eip155%3A8453-0x341c0bee608e9c2d7dd07884328776c5bfb232ace59f4a46714d64a38575d0c7
0x7c11ca505e759b32260a7a1c46b26a484e97e23c-eip155%3A8453-0x42846a3f779a0ae69ac59cb0a937689713f355e02a937d2990bdef0af8369fed
0x7c11ca505e759b32260a7a1c46b26a484e97e23c-eip155%3A8453-0x42846a3f779a0ae69ac59cb0a937689713f355e02a937d2990bdef0af8369fed
0x6bf97afe2d2c790999cded2a8523009eb8a0823f-eip155%3A8453-0xbc9ac616f8809676eefff3abf3487ba2beefc1845f85ac594e062013bdda87ab
0x9729585607568dcbf1f5f3802afbf5b221702932-eip155%3A8453-0x3d050f15e8c2024376d9f37ede2799de569e2b27b214e9915c051c80caa2d309
0x7470a213536b7fb86a84e31c148ef11a1dd3ca52-eip155%3A8453-0xffda6313398f205a0f79120f0a54e1096ab2887baa73490b0451769053d818fa
0x4c5f6ad6628d205259443ebcf6cc4cdd7d6cbf81-eip155%3A8453-0xe17ffc3c7eedaa83a14e965a475abd74aac3a5a5b2432804370143c956a23acb
0x7c11ca505e759b32260a7a1c46b26a484e97e23c-eip155%3A8453-0x42846a3f779a0ae69ac59cb0a937689713f355e02a937d2990bdef0af8369fed
0x7c11ca505e759b32260a7a1c46b26a484e97e23c-eip155%3A8453-0x42846a3f779a0ae69ac59cb0a937689713f355e02a937d2990bdef0af8369fed
0xf70da97812cb96acdf810712aa562db8dfa3dbef-eip155%3A8453-0x511d2dfb144d8bf490ca0772b8a993d06deb6f896c2148561d15318d53110408
0x579c3714ecd756a67449b84c8d306f55f02c4f5b-eip155%3A8453-0xa119b47622d99ed2a58f1d6f500fd364545f9961dbc5852dff1f9acb732c6d7f
0x7cb55d98ac026fb1d987c1e8a4e270c97b24a04c-eip155%3A8453-0xe5e94de848af5b707213382e1f1b3707ce2898491a0b360c8eea3aa0455b3a55
0x31ed51327ba02b6d55d06d9325bebf874fd8ad6a-eip155%3A8453-0x17f4427d75fd1897dc5a043e5738de9ce5cc5ff34f9870705545aa8e224307fb
0x35a7c190cad275d3f9031eea08e2607a5a8656c7-eip155%3A8453-0x31eb33ce725edaffd69ad7838cb543ab7e78f5657753e7fedbe8e3d5c649c7d4
0x2894bfcae3b449959215b89433b860cac7cc3450-eip155%3A8453-0x6432bd13b874d9c9017881d2263366720e784608f3cb6554d54573f065a2994e
0x3d4232fa57eac13f9818c63e9db9e6993cdc10e9-eip155%3A8453-0x6119ee5969067b380d986a91c0f8795fbf6ec0386a106f0ddf0f2787a15fb2c8
0xa7fdcb2cabd232b02e2608e4d6a11e3707be5683-eip155%3A8453-0x68788c052b722db3429afd6353e8ed0cb299e1c929e90c8dee81a0ec7f19bfb7
0x848e6cf692c25f128ea28b55d5bd79626f4f1f22-eip155%3A8453-0xe5e94de848af5b707213382e1f1b3707ce2898491a0b360c8eea3aa0455b3a55
0x900833876d9a70c23303fa06f1a7dfeef29a2473-eip155%3A8453-0xe5e94de848af5b707213382e1f1b3707ce2898491a0b360c8eea3aa0455b3a55
0xb4e633e4d9a96e8c0523053e7a22419bf0d0430b-eip155%3A8453-0x5c25c11c543ee3522fd88c0618689dba4104eecaec7d15da9e3d0714d350c6fe
0x5881056916d20ee59dedea8827388c3aac08f169-eip155%3A8453-0x4680bb4a397a8dd696d3f8e2b172ee8d6e7dc5e445e6928afd4b43559afe1430
0x5881056916d20ee59dedea8827388c3aac08f169-eip155%3A8453-0x4680bb4a397a8dd696d3f8e2b172ee8d6e7dc5e445e6928afd4b43559afe1430
0x5881056916d20ee59dedea8827388c3aac08f169-eip155%3A8453-0x4680bb4a397a8dd696d3f8e2b172ee8d6e7dc5e445e6928afd4b43559afe1430
0x4b5c33c3c7a31bd108f5a99b64683b0056a62226-eip155%3A8453-0x124d41feac6d3bfd139e6d52785940768ea0fc6abfcac0c63ce9e162981bad1f
0x52bfd3eefc5e1aa0fa8f187428894ba4d1474c50-eip155%3A8453-0x5d25f7867803758188298dff9991ab39e1be696066595e070f0b4a37ec26bff0
0x5357e4671eaa4a7367921efc8eb60d56d3650ad5-eip155%3A8453-0xca535de8800ce877b89a362c0e76eb70e7da264dd71fd90067305c735c03fc07
0xf7d1228abb31f2088a48872cc7605f51d97a7041-eip155%3A8453-0xc0f9afbded64fdbe750aaadcbab61724672bb0e44267bd34d7935e3d28fa1365
0x95ec4ba5f88ba6f1d6e0ea0f8d3926b0c08f2c2a-eip155%3A8453-0x36130abc3f8cf56b47e2e70a8fa69d5bc2331572e2f43fb95ebd2d679448ac0b
0x95ec4ba5f88ba6f1d6e0ea0f8d3926b0c08f2c2a-eip155%3A8453-0x36130abc3f8cf56b47e2e70a8fa69d5bc2331572e2f43fb95ebd2d679448ac0b
0x17a7330db952b29b69ba2dbc8ddf7e5049ad624f-eip155%3A8453-0xcee09d8d1e5c892fe5a5cc99abb34b8f7431da6f48976de56c3b7f62bd268c60
0x4f8fc8031e35ea47bea0ff7466f5fc702fa84a63-eip155%3A8453-0xa521490e74303baf59ee55a575d043fb8138fe63f48ad8ca2d14bb1cd90fff9a
0x78246ac69cce0d90a366b2d52064a88bb4ad8467-eip155%3A8453-0x0bb56c543f39c53ac40bc40acc2d9b5e2a783ba9ad103eee6b74779a72c4a661
0xf1aabd8ceba898d84e2f74ea58b81f4d6cc1a10d-eip155%3A8453-0xb693e7b3e71fbdbb082e8436ebae5293386f34f29bb2bd0226fe3ae24816a1f1
0x95ec4ba5f88ba6f1d6e0ea0f8d3926b0c08f2c2a-eip155%3A8453-0x36130abc3f8cf56b47e2e70a8fa69d5bc2331572e2f43fb95ebd2d679448ac0b
0x95ec4ba5f88ba6f1d6e0ea0f8d3926b0c08f2c2a-eip155%3A8453-0x36130abc3f8cf56b47e2e70a8fa69d5bc2331572e2f43fb95ebd2d679448ac0b
0x13f5620fccb28af63e237cc1fdf1eba235a2c016-eip155%3A8453-0xbc6742ef72261402ef7456dc9a6b7896b77383ffc92411f854979daa36667b40
0x4c5f6ad6628d205259443ebcf6cc4cdd7d6cbf81-eip155%3A8453-0xeff15d977d1c1fbf82e67afd570a78826848db1d876de2650dc96f6011608953
0x53881155498cae8660195670591f1e23ae81431f-eip155%3A8453-0x71a8b70ce04701c0027461b291d62e8d1324a73c48401a8735ec8f550083b422
0x579c3714ecd756a67449b84c8d306f55f02c4f5b-eip155%3A8453-0x3418aa85cfc326830314865adc40cfc102c58b3bfdd77dd837688994a7c07afb
0x95ec4ba5f88ba6f1d6e0ea0f8d3926b0c08f2c2a-eip155%3A8453-0x36130abc3f8cf56b47e2e70a8fa69d5bc2331572e2f43fb95ebd2d679448ac0b
0x95ec4ba5f88ba6f1d6e0ea0f8d3926b0c08f2c2a-eip155%3A8453-0x36130abc3f8cf56b47e2e70a8fa69d5bc2331572e2f43fb95ebd2d679448ac0b
0x996ff2ea9f997abf96367b33f5383765bb4de62b-eip155%3A8453-0x728ef837cc87e6a073d1e9aeca72fc31f85f86481189cb423a6258d375551724
0x13f5620fccb28af63e237cc1fdf1eba235a2c016-eip155%3A8453-0x553047aa95a9561e40b92726f212ae7fada5fd31892113340992c35dc361b223
0x501ef174b66883ba40f92e6fb24bfb49331d4d4c-eip155%3A8453-0xb775665f2b9fc97757c479f1be926a9576b085621132c7122418723f8a7f0255
0x53881155498cae8660195670591f1e23ae81431f-eip155%3A8453-0xe3ac31f5143ccf3f3ae9b162ebfc6b3e6e597830e11d0de9e33c886a5d11eb4e
0x11b5004f00e8d4877f6bde10cb70b8d849180115-eip155%3A8453-0x082a1af6f4c995c125983a46b63ca599029a1907c978bf1fb0849e3d5cef5ca7
0x11b5004f00e8d4877f6bde10cb70b8d849180115-eip155%3A8453-0x082a1af6f4c995c125983a46b63ca599029a1907c978bf1fb0849e3d5cef5ca7
0x11b5004f00e8d4877f6bde10cb70b8d849180115-eip155%3A8453-0x082a1af6f4c995c125983a46b63ca599029a1907c978bf1fb0849e3d5cef5ca7
0x11b5004f00e8d4877f6bde10cb70b8d849180115-eip155%3A8453-0x082a1af6f4c995c125983a46b63ca599029a1907c978bf1fb0849e3d5cef5ca7
0x90c5bd83e3ea7204854abbea75abaf1c5c4135b6-eip155%3A8453-0xfdd063a2b71991c0a75fe641dca6a12600b84de393c007e22dabdab8b3cf9419
0x959c96eea36d7cf6e6dc2f9520179dd6fe7a244e-eip155%3A8453-0x7a8f28977bb42660e878ce7a8c34f8c8f0cfcd4e36ca7f9a1fcdd6f8906c4def
0xf70da97812cb96acdf810712aa562db8dfa3dbef-eip155%3A8453-0x2486c8b3ed08019048c75408b0f5c294d988cc306fadc98069c65a9dd5f88409
0x3b22be2c26c7fadb14ca8ee849d92a3c37249a45-eip155%3A8453-0x1000b469bf3e3822b83c21f3557d7e56b90b16a9e7ff3ae0c920c29d8ca4a23e
0x95ec4ba5f88ba6f1d6e0ea0f8d3926b0c08f2c2a-eip155%3A8453-0x36130abc3f8cf56b47e2e70a8fa69d5bc2331572e2f43fb95ebd2d679448ac0b
0x95ec4ba5f88ba6f1d6e0ea0f8d3926b0c08f2c2a-eip155%3A8453-0x36130abc3f8cf56b47e2e70a8fa69d5bc2331572e2f43fb95ebd2d679448ac0b
0x95ec4ba5f88ba6f1d6e0ea0f8d3926b0c08f2c2a-eip155%3A8453-0x36130abc3f8cf56b47e2e70a8fa69d5bc2331572e2f43fb95ebd2d679448ac0b
0x80b3ee0b3ce5a0a8f4f6d2d1e0d9544069243461-eip155%3A8453-0xb655732800fa3beb7c52d86f3371f240485aaf0b10a7759793dd74651cfb6820
0xf70da97812cb96acdf810712aa562db8dfa3dbef-eip155%3A8453-0x23c593762dcea7212fed94d9eda0dc1a8325b23cae5694c82ff599f4a044f65b
0xf4c9b679c97398b06324b10f7e5be44bdcd6960c-eip155%3A8453-0x130ef5ae6e6b0c399528c0e0b53d1c432729a7701af8d212de17ab45df3615f5
0xdba2e9f516d8e37e4c82cf8d2c1594510d787b83-eip155%3A8453-0x7b333d374cf490dee18e5bd5773b56f0325a738343250a62528192a7c939913d
0x639e4bb8d28d477beba288da38696948df14d68e-eip155%3A8453-0x17f4427d75fd1897dc5a043e5738de9ce5cc5ff34f9870705545aa8e224307fb
0x645eb0b5fbbe9b9e6b031bf4bf5080f472eeb201-eip155%3A8453-0x17f4427d75fd1897dc5a043e5738de9ce5cc5ff34f9870705545aa8e224307fb
0x95ec4ba5f88ba6f1d6e0ea0f8d3926b0c08f2c2a-eip155%3A8453-0x36130abc3f8cf56b47e2e70a8fa69d5bc2331572e2f43fb95ebd2d679448ac0b
0x969de568df4cec02e682acf75d7ed9f048de3aba-eip155%3A8453-0xb2b4cbafd26e08b8da26dd3d71b5c7c9cd97efda70d021a2605e1043ad25787a
0x747010709a3f7d5484c0bd313f6d01ad12735480-eip155%3A8453-0x1abfc547d44731ad956ee52ffff04973e5359b6743954a1bca17ed05844be2b8
0x97a1ae7ad300fd2ca19af1a14851c0b159bde82f-eip155%3A8453-0xe5e94de848af5b707213382e1f1b3707ce2898491a0b360c8eea3aa0455b3a55
0x754bf821e90a576f47a291db65f795c2381137ca-eip155%3A8453-0x17f4427d75fd1897dc5a043e5738de9ce5cc5ff34f9870705545aa8e224307fb
0x79d4a9439cd15aacbc144eb56ede65b2b85457aa-eip155%3A8453-0x374fbc0475bc9ef8e4fbdd296d01b34b104ae6887d8d68f6ade59b30a2d06921
0xf70da97812cb96acdf810712aa562db8dfa3dbef-eip155%3A8453-0xb04882a28abde5bb553f8137bfc161b9cd15d4f329796f2b8caa9ec40c5dc0f3
0x4c5f6ad6628d205259443ebcf6cc4cdd7d6cbf81-eip155%3A8453-0xf8b6973b5161c5f23697ca183d99e26fab42ad44c26e40005b1e96ddeec0eecc
0x4ee759fbb7149c95ef79aacbf6610a6dfd2fd687-eip155%3A8453-0xf41f3dabd0f2724d33392b246ddb3181538721c16eb8dbae07b4422be867438b
0x6bf97afe2d2c790999cded2a8523009eb8a0823f-eip155%3A8453-0x239e86804efb86e4dd626be9b872d7e5c0683dd5b2d196e29b63013e96308759
0xc30ae999e2efd260ebe8fe5b39ccc1ee3f3c29be-eip155%3A8453-0xa734640f95a777f1275fcbe595291363b22039e2cc0bd9f8d7eb84f9d3fd10bb
0xb1565e555ef57c62133d813ab2db22d490393aee-eip155%3A8453-0x9a08da94d1d0ec5eff7112d5dd4e6a68f9c9eda040dd55ab052716e46e14afe9
0xb1565e555ef57c62133d813ab2db22d490393aee-eip155%3A8453-0x9a08da94d1d0ec5eff7112d5dd4e6a68f9c9eda040dd55ab052716e46e14afe9
0xf1f7648ff3a1fbd8e2754d75ae8994ecec6b736b-eip155%3A8453-0xebc9ca2808266bcaa575563b7e1612f6ffcdf85e0bbb9f22feaec1a398972b26
0x17d328709db4c5f2cab78bff48de5fa7d949bea2-eip155%3A8453-0x1fa6aee4a2eeb58e43d33ea5cb5505e494b64c2946b12142041afce54c3b3f89
0x4c5f6ad6628d205259443ebcf6cc4cdd7d6cbf81-eip155%3A8453-0xd40628767c6326ff8618f5f5feb220f07d28fbe9d566ecdab8cd240f813c84bb
0x915099b02894be96ef4d350efec9dd356de4e031-eip155%3A8453-0x13dd3dec5645fc8c66f889028b349d0ba2e77ee7904a0943c769ad152ba697f5
0x98ec492942090364ac0736ef1a741ae6c92ec790-eip155%3A8453-0x8db3138718421fb60e3c9359e7724e629d5d86d3b54e458dd978776d18b1153c
0xacf48ce2d39c6e9b1adc8dda9e8c560d06025a1e-eip155%3A8453-0x23363391fb4fadfb9227a39a0960c399405c4e59ee6bb831d84763a7c764f81f
0xce8ec2e14c34b51d097fbcd28d48782d5524339a-eip155%3A8453-0x204d11232dc49b88d67756f5aa47599833d0b54f52e3b8d4dc811952122a4d97
0x0af8528a01b9c7d74e64b70a5fb7fb0930b53bb5-eip155%3A8453-0xe5e94de848af5b707213382e1f1b3707ce2898491a0b360c8eea3aa0455b3a55
0x1b47efd5f4a2389a32d6e9cfae089e8d3f9acdc8-eip155%3A8453-0x60850f008fae137e5f43931bd86341f568dd1f79dc1f79bb47a643b86c6a82c2
0x26fa169e3224ef48cc6710de2472806126d81271-eip155%3A8453-0xe5e94de848af5b707213382e1f1b3707ce2898491a0b360c8eea3aa0455b3a55
0x33c5cafbd58156cdf63d066d487c1c11df52e7c2-eip155%3A8453-0xe575a39cd83fa1cefa0cf590e4515afbdb83cd2a51319f00ba110ab6c10f1dfc
0x37a8ab2b9f6d053a783274f96ea9d8d724ea3718-eip155%3A8453-0x9c3bd0dba70604fe0d34060eb909d2f27ab5136807e0924d77254d0e4994bfbf
0x3906875868d9a9a03c6109c69eec5bd17ea711d8-eip155%3A8453-0xf38c1e0c8436993640dfcec53733a9486c0207b69ef77f5a283de1be8136a2a0
0x39c89876ff884aa44fe75152426f9e2c303e80ac-eip155%3A8453-0xe5e94de848af5b707213382e1f1b3707ce2898491a0b360c8eea3aa0455b3a55
0x45854310c3302c5dab9c0c745e8058d485a4ae8a-eip155%3A8453-0xe5e94de848af5b707213382e1f1b3707ce2898491a0b360c8eea3aa0455b3a55
0x555ce236c0220695b68341bc48c68d52210cc35b-eip155%3A8453-0xab20cd22f0a88db53522e49bff35f468708ec48d8db20701b89eff92575059f4
0x58c64fdadec7ea2e289b61211e63df2ca8494738-eip155%3A8453-0x40d3027b3e95b4a5f800326b89633dfcf30faa351e1f939cb4fae07049606293
EOF

# Run each request
while IFS= read -r ID; do
  [[ -z "$ID" ]] && continue
  echo "=== $ID ==="
  curl -sS -f --location "${BASE}/${ID}" \
    --header "x-request-id: ${REQ_ID}" \
    --header "X-API-Key: ${API_KEY}" \
  | jq -r '
      .data[]
      | .action_items[]
      | .extra_fields as $ef
      | (
          ($ef.swap_info.tokens_sold // [])[]  |
          ["tokens_sold", $ef.id, .token_symbol, .token_address, (.token_circulating_supply // "")]
        ),
        (
          ($ef.swap_info.tokens_bought // [])[] |
          ["tokens_bought", $ef.id, .token_symbol, .token_address, (.token_circulating_supply // "")]
        )
      | @tsv
    ' \
  || echo "Request failed for ${ID}" >&2
done <<< "$IDS"
